autoinstall:
  version: 1

  # Identity setup
  identity:
    hostname: workstation-template
    realname: Admin User
    username: admin
    password: "$6$REPLACE_WITH_YOUR_HASH"   # placeholder hash

  # Keyboard layout
  keyboard:
    layout: us

  # Locale and timezone
  locale: en_US.UTF-8
  timezone: America/New_York

  # Interactive sections
  interactive-sections:
    - network

  # SSH setup
  ssh:
    install-server: true
    authorized-keys:
      - "ssh-ed25519 REPLACE_WITH_PUBLIC_KEY"
    allow-pw: false

  # During installation
  error-commands:
    - "tar -czf /installer-logs.tar.gz /var/log/installer"
    - "journalctl -b > /installer-journal.log"

  # After installation
  late-commands:
    - curtin in-target --target=/target -- bash -c 'apt update -y'
    - curtin in-target --target=/target -- bash -c 'apt upgrade -y'
    - curtin in-target --target=/target -- bash -c 'systemctl enable ssh'
    - curtin in-target --target=/target -- bash -c 'systemctl start ssh'
    - curtin in-target --target=/target -- bash -c 'ufw allow OpenSSH'
    - curtin in-target --target=/target -- bash -c 'sleep 2 && ufw --force enable'
